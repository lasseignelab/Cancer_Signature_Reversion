---
title: "220614_LINCS_profile_candidates_all_cancers"
author: "Jennifer Fisher"
date: "6/14/2022"
output:
  html_document:
    toc: true
    theme: united
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# START 
    Goal/Purpose of operations: 
    The goal of this script is compare the drug candidates for each method across the different cancers. This is done with cosine similarity and network analysis 
    
    Finished psedocode on: 
    220614
    
    System which operations were done on: 
    my laptop
    
    GitHub Repo:
    Transfer_Learning_R03
    
    Docker/Singularity: 
    rstudio_cancer_dr
    
    Directory of operations: 
    "/home/rstudio"
    
    Scripts being edited for operations: 
    "/home/rstudio/script/functions_cancer_signature_reversion_JLF.R - functions are stored here
    
    Data being used: 
    LINCS level 5 data
    drug candidate for each cancer
    
    Papers and tools: 
    noted within script

# STEPS
### Set working directory 
### load in data
```{r}
library(recount3)
library(SummarizedExperiment)
source("/home/rstudio/script/functions_cancer_signature_reversion_JLF.R")
library(signatureSearch)
library(HDF5Array)
library(viridis)
library(tidyr)
library(gprofiler2)
library(ggplot2)
library(ggpubr)
library(VennDiagram)
library(ComplexHeatmap)
library(dplyr)
library(gplots)
library(circlize)
library(signatureSearch)
library(HDF5Array)
library(igraph)
library(visNetwork)
library(stringr)
library(readr)
```

get the LINCS data
```{r}
se <- SummarizedExperiment(HDF5Array("~/data/lincs_2020.h5", name="assay"))
rownames(se) <- HDF5Array("~/data/lincs_2020.h5", name="rownames")
colnames(se) <- HDF5Array("~/data/lincs_2020.h5", name="colnames")
se_assay <- as.data.frame(assay(se))
```

get drug candidates

gbm
```{r }
lincs_limma_gbm_res_GI1_fda_approved<- read_csv( "~/output/limma_GBM/220808_SR_LINCS_GBM_top_RES_all.csv")
lincs_deseq_gbm_res_GI1_fda_approved<- read_csv( "~/output/deseq2_gbm/220928_SR_LINCS_GBM_DESEQ2_RES_all.csv")
lincs_tfl_gbm_res_GI1_fda_approved<- read_csv( "~/output/TF_L_GBM/220808_SR_LINCS_GBM_top_RES_all.csv")
```

liver
```{r}
lincs_deseq_gbm_res_HEPG2_fda_approved <- read_csv("~/output/liver_cancer/deseq2_res/220929_SR_LINCS_LIHC_DESEQ2_RES_tau.csv")
lincs_deseq_gbm_res_HEPG2_fda_approved <- lincs_deseq_gbm_res_HEPG2_fda_approved [lincs_deseq_gbm_res_HEPG2_fda_approved$fda_approved== TRUE,]

lincs_limma_gbm_res_HEPG2_fda_approved <- read_csv("~/output/liver_cancer/limma_res/220808_SR_LINCS_LIHC_limma_RES_tau.csv")

lincs_limma_gbm_res_HEPG2_fda_approved<- lincs_limma_gbm_res_HEPG2_fda_approved[ lincs_limma_gbm_res_HEPG2_fda_approved$fda_approved== TRUE,]
#wrong date on file
lincs_tfl_gbm_res_HEPG2_fda_approved <- read_csv("~/output/liver_cancer/TFL_res/220602_SR_LINCS_LIHC_TFL_RES_tau.csv")
lincs_tfl_gbm_res_HEPG2_fda_approved<- lincs_tfl_gbm_res_HEPG2_fda_approved[ lincs_tfl_gbm_res_HEPG2_fda_approved$fda_approved == TRUE, ]
```
lung
```{r}
#comment.   
lincs_limma_gbm_res_A549_fda_approved<- read_csv("~/output/lung_cancer/limma_res/220808_SR_LINCS_LUAD_limma_RES_tau.csv")
lincs_limma_gbm_res_A549_fda_approved<- lincs_limma_gbm_res_A549_fda_approved[lincs_limma_gbm_res_A549_fda_approved$fda_approved == TRUE, ]
lincs_deseq_gbm_res_A549_fda_approved<- read_csv("~/output/lung_cancer/deseq2_res/220929_SR_LINCS_LUAD_DESEQ2_RES_tau.csv")
lincs_deseq_gbm_res_A549_fda_approved<- lincs_deseq_gbm_res_A549_fda_approved[lincs_deseq_gbm_res_A549_fda_approved$fda_approved == TRUE, ]
lincs_tfl_gbm_res_A549_fda_approved<- read_csv("~/output/lung_cancer/TFL_res/220808_SR_LINCS_LUAD_TFL_RES_tau.csv")
lincs_tfl_gbm_res_A549_fda_approved<- lincs_tfl_gbm_res_A549_fda_approved[lincs_tfl_gbm_res_A549_fda_approved$fda_approved==TRUE,]
```

pancreatic
```{r}
lincs_deseq_gbm_res_YAPC_fda_approved <- read_csv("~/output/pancreas_cancer/deseq2_res/220929_SR_LINCS_PAAD_DESEQ2_RES_tau.csv")
lincs_deseq_gbm_res_YAPC_fda_approved<- lincs_deseq_gbm_res_YAPC_fda_approved[lincs_deseq_gbm_res_YAPC_fda_approved$fda_approved == TRUE,]

lincs_limma_gbm_res_YAPC_fda_approved <- read_csv("~/output/pancreas_cancer/limma_res/220808_SR_LINCS_PAAD_limma_RES_tau.csv")
lincs_limma_gbm_res_YAPC_fda_approved<- lincs_limma_gbm_res_YAPC_fda_approved[lincs_limma_gbm_res_YAPC_fda_approved$fda_approved ==TRUE, ]

lincs_tfl_gbm_res_YAPC_fda_approved <- read_csv("~/output/pancreas_cancer/TFL_res/220808_SR_LINCS_PAAD_TFL_RES_tau.csv")
lincs_tfl_gbm_res_YAPC_fda_approved<- lincs_tfl_gbm_res_YAPC_fda_approved[ lincs_tfl_gbm_res_YAPC_fda_approved$fda_approved ==TRUE,]
```
# Analysis

heatmap and network stuff for GBM 
```{r}
col_fun <- colorRamp2(c(-1, 0, 1), c("blue", "black", "yellow"))
cos_gbm_candidates <- candidate_cosine_data_heatmap(lincs=se_assay, "GI1",lincs_deseq_gbm_res_GI1_fda_approved$pert, lincs_limma_gbm_res_GI1_fda_approved$pert, lincs_tfl_gbm_res_GI1_fda_approved$pert)
```

```{r}
candidate_network_analysis( cos_gbm_candidates, lincs_deseq_gbm_res_GI1_fda_approved$pert, lincs_limma_gbm_res_GI1_fda_approved$pert, lincs_tfl_gbm_res_GI1_fda_approved$pert, quantile= 9, header= "~/output/gbm_plots/220817_network_analysis_gbm")
```

heatmap and network stuff for liver
```{r}
cos_liver_candidates <- candidate_cosine_data_heatmap(lincs=se_assay, "HEPG2",lincs_deseq_gbm_res_HEPG2_fda_approved$pert, lincs_limma_gbm_res_HEPG2_fda_approved$pert, lincs_tfl_gbm_res_HEPG2_fda_approved$pert)
```

```{r}
candidate_network_analysis( cos_liver_candidates, lincs_deseq_gbm_res_HEPG2_fda_approved$pert, lincs_limma_gbm_res_HEPG2_fda_approved$pert, lincs_tfl_gbm_res_HEPG2_fda_approved$pert, quantile= 9, header= "~/output/liver_cancer/220817_network_analysis_liver")
```

heatmap and network stuff for lung
```{r}
cos_lung_candidates <- candidate_cosine_data_heatmap(lincs=se_assay, "A549",lincs_deseq_gbm_res_A549_fda_approved$pert, lincs_limma_gbm_res_A549_fda_approved$pert, lincs_tfl_gbm_res_A549_fda_approved$pert)
```

```{r}
candidate_network_analysis( cos_lung_candidates, lincs_deseq_gbm_res_A549_fda_approved$pert, lincs_limma_gbm_res_A549_fda_approved$pert, lincs_tfl_gbm_res_A549_fda_approved$pert, quantile= 9, header= "~/output/lung_cancer/220817_network_analysis_lung")
```

heatmap and network stuff for pancreatic
```{r}
cos_PAAD_candidates <- candidate_cosine_data_heatmap(lincs=se_assay, "YAPC",lincs_deseq_gbm_res_YAPC_fda_approved$pert, lincs_limma_gbm_res_YAPC_fda_approved$pert, lincs_tfl_gbm_res_YAPC_fda_approved$pert)
```

```{r}
candidate_network_analysis( cos_PAAD_candidates, lincs_deseq_gbm_res_YAPC_fda_approved$pert, lincs_limma_gbm_res_YAPC_fda_approved$pert, lincs_tfl_gbm_res_YAPC_fda_approved$pert, quantile= 9, header= "~/output/pancreas_cancer/220817_network_analysis_paad")
```

### Save Data
NA

### Save Figures
done
    
# END
    Location of final scripts:
    script 
    
    Location of data produced:
    ~/output
    
    Dates when operations were done:
    220817
    
## Versions
```{r}
sessionInfo()
```


