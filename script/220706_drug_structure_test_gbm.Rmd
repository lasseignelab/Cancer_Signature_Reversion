---
title: "220706_drug_structures"
author: "Jennifer Fisher"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# START 
    Goal/Purpose of operations: 
    Investigating the similarity of drug candidates' structures. Wanting to address if the candidates are different between methods. Drug structures have been used in drug repurposing to identify candidates with drugs with similar structures. 
    
    Finished psedocode on: 
    220709
    
    System which operations were done on: 
    my laptop
    
    GitHub Repo:
    Transfer_Learning_R03
    
    Docker:
    rstudio_cancer_dr
    
    Directory of operations: 
    /home/rstudio/ "Docker"
    
    Scripts being edited for operations: 
    script/functions_cancer_signature_reversion_JLF.R
    
    Data being used:
   The drug structure data files for the different candidates were accessed via customCMPdbâ€™s loadSDFwithName function for the LINCS dataset (Accessed date: July. 2022). 
   The FDA-approved candidates from all the cancers
    
    Papers and tools: 
    ChemmineR was used to calculate the smilialrity between the methods. 
    igrpah was used for PPI network analysis. 
    

# STEPS
### Set working directory 
```{r}
library(customCMPdb)
library(ChemmineR)
library(readr)
library(AnnotationHub)
library(RSQLite)
library(ComplexHeatmap)
library(circlize)
library(fmcsR)
library(igraph)
library(visNetwork)
library(viridis)
library(signatureSearch)
library(HDF5Array)
library(tidyr)
library(gprofiler2)
library(ggplot2)
library(ggpubr)
library(VennDiagram)
library(dplyr)
library(gplots)
source("/home/rstudio/script/functions_cancer_signature_reversion_JLF.R")
```
### load in data

LINCS compound information
```{r}
lincs_commpound_info <- read.delim("~/data/LINCS_210914_LEVEL3/compoundinfo_beta.txt")
```

LINCS drug structure information 
```{r}
lincs_sdfset <- loadSDFwithName(source="LINCS")
```

gbm candidates
```{r}
lincs_limma_gbm_res_GI1_fda_approved<- read_csv( "~/output/limma_gbm/220808_SR_LINCS_GBM_top_RES_all.csv")
lincs_deseq2_gbm_res_GI1_fda_approved <- read_csv( "~/output/deseq2_gbm/220928_SR_LINCS_GBM_DESEQ2_RES_all.csv")
lincs_tfl_gbm_res_GI1_fda_approved <- read_csv( "~/output/TF_L_GBM/220808_SR_LINCS_GBM_top_RES_all.csv")
```

liver candidates
```{r}
lincs_deseq_gbm_res_HEPG2_fda_approved <- read_csv("~/output/liver_cancer/deseq2_res/220929_SR_LINCS_LIHC_DESEQ2_RES_tau.csv")
lincs_deseq_gbm_res_HEPG2_fda_approved <- lincs_deseq_gbm_res_HEPG2_fda_approved [lincs_deseq_gbm_res_HEPG2_fda_approved$fda_approved== TRUE,]

lincs_limma_gbm_res_HEPG2_fda_approved <- read_csv("~/output/liver_cancer/limma_res/220808_SR_LINCS_LIHC_limma_RES_tau.csv")

lincs_limma_gbm_res_HEPG2_fda_approved<- lincs_limma_gbm_res_HEPG2_fda_approved[ lincs_limma_gbm_res_HEPG2_fda_approved$fda_approved== TRUE,]
#wrong date on file
lincs_tfl_gbm_res_HEPG2_fda_approved <- read_csv("~/output/liver_cancer/TFL_res/220602_SR_LINCS_LIHC_TFL_RES_tau.csv")
lincs_tfl_gbm_res_HEPG2_fda_approved<- lincs_tfl_gbm_res_HEPG2_fda_approved[ lincs_tfl_gbm_res_HEPG2_fda_approved$fda_approved == TRUE, ]
```

lung candidates
```{r}
#comment.   
lincs_limma_gbm_res_A549_fda_approved<- read_csv("~/output/lung_cancer/limma_res/220808_SR_LINCS_LUAD_limma_RES_tau.csv")
lincs_limma_gbm_res_A549_fda_approved<- lincs_limma_gbm_res_A549_fda_approved[lincs_limma_gbm_res_A549_fda_approved$fda_approved == TRUE, ]
lincs_deseq_gbm_res_A549_fda_approved<- read_csv("~/output/lung_cancer/deseq2_res/220929_SR_LINCS_LUAD_DESEQ2_RES_tau.csv")
lincs_deseq_gbm_res_A549_fda_approved<- lincs_deseq_gbm_res_A549_fda_approved[lincs_deseq_gbm_res_A549_fda_approved$fda_approved == TRUE, ]
lincs_tfl_gbm_res_A549_fda_approved<- read_csv("~/output/lung_cancer/TFL_res/220808_SR_LINCS_LUAD_TFL_RES_tau.csv")
lincs_tfl_gbm_res_A549_fda_approved<- lincs_tfl_gbm_res_A549_fda_approved[lincs_tfl_gbm_res_A549_fda_approved$fda_approved==TRUE,]
```

pancreatic candidates
```{r}
lincs_deseq_gbm_res_YAPC_fda_approved <- read_csv("~/output/pancreas_cancer/deseq2_res/220929_SR_LINCS_PAAD_DESEQ2_RES_tau.csv")
lincs_deseq_gbm_res_YAPC_fda_approved<- lincs_deseq_gbm_res_YAPC_fda_approved[lincs_deseq_gbm_res_YAPC_fda_approved$fda_approved == TRUE,]

lincs_limma_gbm_res_YAPC_fda_approved <- read_csv("~/output/pancreas_cancer/limma_res/220808_SR_LINCS_PAAD_limma_RES_tau.csv")
lincs_limma_gbm_res_YAPC_fda_approved<- lincs_limma_gbm_res_YAPC_fda_approved[lincs_limma_gbm_res_YAPC_fda_approved$fda_approved ==TRUE, ]

lincs_tfl_gbm_res_YAPC_fda_approved <- read_csv("~/output/pancreas_cancer/TFL_res/220808_SR_LINCS_PAAD_TFL_RES_tau.csv")
lincs_tfl_gbm_res_YAPC_fda_approved<- lincs_tfl_gbm_res_YAPC_fda_approved[ lincs_tfl_gbm_res_YAPC_fda_approved$fda_approved ==TRUE,]
```

# Analysis

## Determine the smilarity vis Tanimoto coffieient for the candidate drug strutures (if they exiist; some don't)

```{r}
drug_gbm_res<- drug_struc_heatmap(lincs_limma_gbm_res_GI1_fda_approved$pert,  lincs_deseq2_gbm_res_GI1_fda_approved$pert, lincs_tfl_gbm_res_GI1_fda_approved$pert, "~/output/gbm_plots/220830_drug_struct_gbm_Tanimoto_Coefficient.png")
```

```{r}
candidate_network_analysis( as.matrix(drug_gbm_res), lincs_deseq2_gbm_res_GI1_fda_approved$pert, lincs_limma_gbm_res_GI1_fda_approved$pert, lincs_tfl_gbm_res_GI1_fda_approved$pert, quantile= 9, header= "~/output/gbm_plots/220830_drug_struct_gbm_Tanimoto_Coefficient")
```


```{r}
drug_pan_res<-drug_struc_heatmap(lincs_limma_gbm_res_YAPC_fda_approved$pert,  lincs_deseq_gbm_res_YAPC_fda_approved$pert, lincs_tfl_gbm_res_YAPC_fda_approved$pert, "~/output/pancreas_cancer/220830_drug_struct_yapc_Tanimoto_Coefficient.png")
```

```{r}
candidate_network_analysis( drug_pan_res, lincs_deseq_gbm_res_YAPC_fda_approved$pert, lincs_limma_gbm_res_YAPC_fda_approved$pert, lincs_tfl_gbm_res_YAPC_fda_approved$pert, quantile= 9, header= "~/output/pancreas_cancer/220830_drug_struct_yapc_Tanimoto_Coefficient")
```

```{r}
drug_liver_res<- drug_struc_heatmap(lincs_limma_gbm_res_HEPG2_fda_approved$pert,  lincs_deseq_gbm_res_HEPG2_fda_approved$pert, lincs_tfl_gbm_res_HEPG2_fda_approved$pert, "~/output/liver_cancer/220830_drug_struct_liver_Tanimoto_Coefficient.png")
```

```{r}
candidate_network_analysis( drug_liver_res, lincs_deseq_gbm_res_HEPG2_fda_approved$pert, lincs_limma_gbm_res_HEPG2_fda_approved$pert, lincs_tfl_gbm_res_HEPG2_fda_approved$per, quantile= 9, header= "~/output/liver_cancer/220830_drug_struct_liver_Tanimoto_Coefficient")
```

```{r}
drug_lung_res<-drug_struc_heatmap(lincs_limma_gbm_res_A549_fda_approved$pert,  lincs_deseq_gbm_res_A549_fda_approved$pert, lincs_tfl_gbm_res_A549_fda_approved$pert, "~/output/lung_cancer/220830_drug_struct_lung_Tanimoto_Coefficient.png")
```

```{r}
candidate_network_analysis( drug_lung_res, lincs_deseq_gbm_res_A549_fda_approved$pert, lincs_limma_gbm_res_A549_fda_approved$pert, lincs_tfl_gbm_res_A549_fda_approved$pert, "~/output/lung_cancer/220830_drug_struct_lung_Tanimoto_Coefficien", quantile= 9)
```


### Save Data
NA

### Save Figures
done
    
# END
    Location of final scripts:
    script 
    
    Location of data produced:
    ~/output
    
    Dates when operations were done:
    221003
    
## Versions
```{r}
sessionInfo()
```

