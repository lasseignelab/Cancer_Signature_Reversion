---
title: "220805_network_differences_methods"
author: "Jennifer Fisher"
date: "8/5/2022"
output:
  html_document:
    toc: true
    theme: united
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# START 
    Goal/Purpose of operations: 
    To compare the centrality metrics for the disease genes from limma, DESeq2, and the transfer learning approach, we compared the distribution of the log2-transformed metrics (degree, betweenness, and Eigenvalue of centrality) of the unique genes identified by the methods. Then we conducted a Kruskal-Wallis test to determine if there were differences between the three methods. If this was significant ( É‘ = 0.05), then a pairwise Wilcox test with Benjamini Hochberg p-value adjustment was applied. We did not consider overlapping genes due to the assumption of independence for both the Kruskal-Wallis and pairwise Wilcox tests. 

    
    Finished psedocode on: 
    220323
    
    System which operations were done on: 
    my laptop
    
    GitHub Repo:
    Transfer_learning_R03
    
    Docker:
    rstudio_cancer_dr
    
    Directory of operations: 
    /home/rstudio/ "Docker"
    
    Scripts being edited for operations: 
    NA
    
    Data being used:
    For this analysis, the human protein-protein interaction (PPI) networks were downloaded from the STRING database (March 2022; version 11.5). This database contains known and predicted protein-protein interactions that include direct and indirect associations.
    Also the limma, deseq2, and transfere leanring results for GBM
    
    Papers and tools: 
    igrpah was used for PPI network analysis. 
    gPROFILER2 was used for pathway analysis.
    
# STEPS
### Set working directory 
```{r}
library(recount3)
library(SummarizedExperiment)
source("/home/rstudio/script/functions_cancer_signature_reversion_JLF.R")
library(signatureSearch)
library(HDF5Array)
library(viridis)
library(tidyr)
library(gprofiler2)
library(ggplot2)
library(ggpubr)
library(VennDiagram)
library(ComplexHeatmap)
library(dplyr)
library(gplots)
library(circlize)
source("~/script/plier_util.R")
source("~/script/test_LV_differences.R")
library(dplyr)
library(gridExtra)
```
### load in data
```{r}
string_ppi_details<- readRDS("~/string_ppi_metrics.rds")
```

gbm
```{r}
gbm_tfl_input <- readRDS("~/output/TF_L_GBM/22004_SR_gene_list_gbm_tfl.rds")
gbm_deseq2_input<- readRDS("~/output/deseq2_gbm/SR_gene_list_gbm_deseq2.rds")
gbm_limma_input<- readRDS("~/output/limma_gbm/SR_gene_list_gbm_limma.rds")
```

liver 
```{r}
liver_tfl_input <- readRDS("~/output/liver_cancer/TFL_res/SR_gene_list_liver_tfl.rds")
liver_deseq2_input <- readRDS("~/output/liver_cancer/deseq2_res/SR_gene_list_liver_deseq2.rds")
liver_limma_input <- readRDS("~/output/liver_cancer/limma_res/SR_gene_list_liver_limma.rds")
```

lung 
```{r}
lung_deseq2_input <- readRDS("~/output/lung_cancer/deseq2_res/SR_gene_list_luad_deseq2.rds")
lung_tfl_input<- readRDS("~/output/lung_cancer/deseq2_res/SR_gene_list_lung_tfl.rds")
lung_limma_input<- readRDS("~/output/lung_cancer/deseq2_res/SR_gene_list_lung_limma.rds")
```

pancreas
```{r}
paad_tfl_input <- readRDS("~/output/pancreas_cancer/TFL_res/SR_gene_list_paad_tfl.rds")
paad_limma_input <- readRDS("~/output/pancreas_cancer/limma_res/SR_gene_list_paad_limma.rds")
paad_deseq2_input <- readRDS("~/output/pancreas_cancer/deseq2_res/SR_gene_list_paad_deseq2.rds")
```


```{r}
string_ppi_details$degree_log <- log(string_ppi_details$degree + 1)
string_ppi_details$log_betweness <- log(string_ppi_details$betweenness +1)
string_ppi_details$eign_cent_log <- log(string_ppi_details$eign_cent)
string_ppi_details$genes<- rownames(string_ppi_details)
```

### Analysis


```{r}
set.seed(101)
network_cent_method_plotting(gbm_limma_input, gbm_deseq2_input, gbm_tfl_input, string_ppi_details= string_ppi_details, "~/output/gbm_plots/220822_network_gbm_")
```



```{r}
set.seed(101)
network_cent_method_plotting(liver_limma_input, liver_deseq2_input, liver_tfl_input, string_ppi_details= string_ppi_details,"~/output/liver_cancer/220822_network_liver_" )
```

```{r}
set.seed(101)
network_cent_method_plotting(lung_limma_input, lung_deseq2_input, lung_tfl_input, string_ppi_details= string_ppi_details, "~/output/lung_cancer/220822_network_lung_" )
```

```{r}
set.seed(101)
network_cent_method_plotting(paad_limma_input, paad_deseq2_input, paad_tfl_input, string_ppi_details= string_ppi_details, "~/output/pancreas_cancer/220822_network_paad_" )
```
### Save Data
NA

### Save Figures
done
    
# END
    Location of final scripts:
    script 
    
    Location of data produced:
    ~/output
    
    Dates when operations were done:
    220822
    
## Versions
```{r}
sessionInfo()
```
